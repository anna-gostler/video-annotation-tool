{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\anna_\\\\azuretest\\\\annotation-tool\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\anna_\\\\azuretest\\\\annotation-tool\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\anna_\\\\azuretest\\\\annotation-tool\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\anna_\\\\azuretest\\\\annotation-tool\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"C:\\\\Users\\\\anna_\\\\azuretest\\\\annotation-tool\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\anna_\\\\azuretest\\\\annotation-tool\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import ReactDOM from'react-dom';import ResizeBox from'./ResizeBox';var BoundingBox=/*#__PURE__*/function(_React$Component){_inherits(BoundingBox,_React$Component);function BoundingBox(props){var _this;_classCallCheck(this,BoundingBox);_this=_possibleConstructorReturn(this,_getPrototypeOf(BoundingBox).call(this,props));_this.componentDidMount=function(){ReactDOM.findDOMNode(_assertThisInitialized(_this)).addEventListener('mousedown',_this.handleMouseDown);ReactDOM.findDOMNode(_assertThisInitialized(_this)).addEventListener('mousemove',_this.handleDrag);//in handle: remove 'mousedown' while mouse down, add when mouse up\nif(_this.props.isSelected){//console.log('mount selected element ' + this.props.number)\n//ReactDOM.findDOMNode(this).addEventListener('mousedown', this.handleMouseDown); \n}else{}//console.log('mount un-selected element')\n//in handle: remove 'mouseup' while mouse up, add when mouse down\n//in handle: remove 'mousemove' while mouse up, add when mouse down\n};_this.componentWillUnmount=function(){// remove all listeners that are attached to this\nReactDOM.findDOMNode(_assertThisInitialized(_this)).removeEventListener('mousedown',_this.handleMouseDown);document.removeEventListener('mouseup',_this.handleMouseUp);document.removeEventListener('mousemove',_this.handleMouseUp);};_this.handleResize=function(event){console.log('handle resize');// only if this is the selected bbox\nif(_this.props.isSelected){if(event.type==='mousedown'){//console.log('clicked: resize me')\n// enter resize state\n_this.setState({resizeModeOn:true});_this.setState({ElementStyle:{left:_this.state.ElementStyle.left,top:_this.state.ElementStyle.top,height:_this.state.ElementStyle.height,width:_this.state.ElementStyle.width,cursor:\"nw-resize\"}});document.addEventListener('mousemove',_this.handleResize);}else if(event.type==='mousemove'){//console.log('listen for mouse-up')\ndocument.addEventListener('mouseup',_this.handleMouseUp);_this.setState({ElementStyle:{left:_this.state.ElementStyle.left,top:_this.state.ElementStyle.top,height:_this.state.ElementStyle.height,width:_this.state.ElementStyle.width,cursor:\"nw-resize\"}});_this.setState({possibleResizeModeOn:true});if(_this.state.resizeModeOn){var minwidthheight=5;var offset_framearea=100;// stop if width/height == 0\nif(_this.state.w>=minwidthheight){// add mouse-position to width\n_this.setState({w:Math.max(minwidthheight,event.pageX-_this.state.l-offset_framearea)});_this.setState({ElementStyle:{left:_this.state.ElementStyle.left,top:_this.state.ElementStyle.top,height:_this.state.ElementStyle.height,width:_this.state.w+\"px\",cursor:\"nw-resize\"}});}if(_this.state.h>=minwidthheight){// add mouse-position to height\n_this.setState({h:Math.max(minwidthheight,event.pageY-_this.state.t-offset_framearea)});_this.setState({ElementStyle:{left:_this.state.ElementStyle.left,top:_this.state.ElementStyle.top,height:_this.state.h+\"px\",width:_this.state.ElementStyle.width,cursor:\"nw-resize\"}});}// only pass changed values to parent\n_this.props.handleBBoxUpdate(_this.state.l,_this.state.t,_this.state.w,_this.state.h,_this.props.number);}}else if(event.type===\"mouseout\"){_this.setState({possibleResizeModeOn:false,ElementStyle:{left:_this.state.ElementStyle.left,top:_this.state.ElementStyle.top,height:_this.state.ElementStyle.height,width:_this.state.ElementStyle.width,cursor:\"move\"}});}}else{_this.setState({possibleResizeModeOn:false,ElementStyle:{left:_this.state.ElementStyle.left,top:_this.state.ElementStyle.top,height:_this.state.ElementStyle.height,width:_this.state.ElementStyle.width,cursor:\"default\"}});}};_this.handleMouseDown=function(event){// only if this is the selected bbox\nif(_this.props.isSelected){//check if resize is on\n// if click is inside resize-box -> resize\n// otherwise -> drag\nif(_this.state.possibleResizeModeOn===false){_this.setState({dragModeOn:true,diffx:event.pageX-_this.state.l,diffy:event.pageY-_this.state.t});document.addEventListener('mousemove',_this.handleDrag);ReactDOM.findDOMNode(_assertThisInitialized(_this)).removeEventListener('mousedown',_this.handleMouseDown);document.addEventListener('mouseup',_this.handleMouseUp);}}else{_this.setState({possibleResizeModeOn:false,ElementStyle:{left:_this.state.ElementStyle.left,top:_this.state.ElementStyle.top,height:_this.state.ElementStyle.height,width:_this.state.ElementStyle.width,cursor:\"default\"}});}};_this.handleMouseUp=function(event){if(_this.props.isSelected){//console.log('handle mouse up - remove mouse move listener')\ndocument.removeEventListener('mousemove',_this.handleResize);_this.setState({ElementStyle:{left:_this.state.ElementStyle.left,top:_this.state.ElementStyle.top,height:_this.state.ElementStyle.height,width:_this.state.ElementStyle.width,cursor:\"move\"}});_this.setState({dragModeOn:false,possibleResizeModeOn:false,resizeModeOn:false});document.removeEventListener('mousemove',_this.handleDrag);if(ReactDOM.findDOMNode(_assertThisInitialized(_this))!==undefined){ReactDOM.findDOMNode(_assertThisInitialized(_this)).addEventListener('mousedown',_this.handleMouseDown);}document.removeEventListener('mouseup',_this.handleMouseUp);}else{_this.setState({possibleResizeModeOn:false,ElementStyle:{left:_this.state.ElementStyle.left,top:_this.state.ElementStyle.top,height:_this.state.ElementStyle.height,width:_this.state.ElementStyle.width,cursor:\"default\"}});}};_this.handleDrag=function(event){if(_this.props.isSelected){_this.setState({ElementStyle:{left:_this.state.ElementStyle.left,top:_this.state.ElementStyle.top,height:_this.state.ElementStyle.height,width:_this.state.ElementStyle.width,cursor:\"move\"}});if(_this.state.dragModeOn===true){_this.setState({l:event.pageX-_this.state.diffx,t:event.pageY-_this.state.diffy});_this.setState({ElementStyle:{left:event.pageX-_this.state.diffx+\"px\",top:event.pageY-_this.state.diffy+\"px\",height:_this.state.ElementStyle.height,width:_this.state.ElementStyle.width,cursor:\"move\"}});_this.props.handleBBoxUpdate(_this.state.l,_this.state.t,_this.state.w,_this.state.h,_this.props.number);}}else{_this.setState({possibleResizeModeOn:false,ElementStyle:{left:_this.state.ElementStyle.left,top:_this.state.ElementStyle.top,height:_this.state.ElementStyle.height,width:_this.state.ElementStyle.width,cursor:\"default\"}});}};_this.state={ElementStyle:{left:props.l+\"px\",top:props.t+\"px\",width:props.w+\"px\",height:props.h+\"px\",cursor:\"default\"},l:props.l,t:props.t,h:props.h,w:props.w,diffx:0,diffy:0,dragModeOn:false,resizeModeOn:false,possibleResizeModeOn:false// if active -> do not drag\n};_this.handleResize=_this.handleResize.bind(_assertThisInitialized(_this));return _this;}_createClass(BoundingBox,[{key:\"render\",value:function render(){// add resize box only to selected element\nvar resizebox;if(this.props.isSelected){resizebox=React.createElement(ResizeBox,{posx:this.state.w-5+\"px\",posy:this.state.h-5+\"px\",handleResize:this.handleResize});}return React.createElement(\"div\",{className:this.props.classname,style:this.state.ElementStyle},resizebox);}}]);return BoundingBox;}(React.Component);export default BoundingBox;","map":{"version":3,"sources":["C:/Users/anna_/azuretest/annotation-tool/src/BoundingBox.jsx"],"names":["React","ReactDOM","ResizeBox","BoundingBox","props","componentDidMount","findDOMNode","addEventListener","handleMouseDown","handleDrag","isSelected","componentWillUnmount","removeEventListener","document","handleMouseUp","handleResize","event","console","log","type","setState","resizeModeOn","ElementStyle","left","state","top","height","width","cursor","possibleResizeModeOn","minwidthheight","offset_framearea","w","Math","max","pageX","l","h","pageY","t","handleBBoxUpdate","number","dragModeOn","diffx","diffy","undefined","bind","resizebox","classname","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport ResizeBox from './ResizeBox'\r\n\r\n\r\nclass BoundingBox extends React.Component {\r\n\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n        ElementStyle: {\r\n          left: props.l + \"px\",\r\n          top: props.t + \"px\",\r\n          width: props.w + \"px\",\r\n          height: props.h + \"px\",\r\n          cursor: \"default\",\r\n        },\r\n        l: props.l,\r\n        t: props.t,\r\n        h: props.h,\r\n        w: props.w,\r\n        diffx: 0,\r\n        diffy: 0,\r\n        dragModeOn: false,\r\n        resizeModeOn: false,\r\n        possibleResizeModeOn: false, // if active -> do not drag\r\n      };\r\n  \r\n  \r\n      this.handleResize = this.handleResize.bind(this)\r\n    }\r\n  \r\n    componentDidMount = () => {\r\n  \r\n          ReactDOM.findDOMNode(this).addEventListener('mousedown', this.handleMouseDown); \r\n          ReactDOM.findDOMNode(this).addEventListener('mousemove', this.handleDrag); \r\n  \r\n          //in handle: remove 'mousedown' while mouse down, add when mouse up\r\n          if (this.props.isSelected){\r\n            //console.log('mount selected element ' + this.props.number)\r\n            //ReactDOM.findDOMNode(this).addEventListener('mousedown', this.handleMouseDown); \r\n          }else{\r\n            //console.log('mount un-selected element')\r\n          }\r\n  \r\n          //in handle: remove 'mouseup' while mouse up, add when mouse down\r\n          //in handle: remove 'mousemove' while mouse up, add when mouse down\r\n    }\r\n  \r\n    componentWillUnmount = () => {\r\n      // remove all listeners that are attached to this\r\n      ReactDOM.findDOMNode(this).removeEventListener('mousedown', this.handleMouseDown); \r\n      document.removeEventListener('mouseup', this.handleMouseUp); \r\n      document.removeEventListener('mousemove', this.handleMouseUp); \r\n    }\r\n  \r\n    render() {\r\n      // add resize box only to selected element\r\n  \r\n      var resizebox;\r\n      if (this.props.isSelected) {\r\n        resizebox = (\r\n        <ResizeBox posx={(this.state.w - 5) + \"px\"} posy={(this.state.h - 5) + \"px\"} \r\n        handleResize = {this.handleResize}\r\n        ></ResizeBox>)\r\n      }\r\n  \r\n      return (\r\n        <div className ={this.props.classname} style={this.state.ElementStyle} >\r\n          {resizebox}\r\n        </div>\r\n      );\r\n    }\r\n  \r\n    handleResize = (event) => {\r\n      console.log('handle resize')\r\n      // only if this is the selected bbox\r\n      if(this.props.isSelected){\r\n      if (event.type === 'mousedown'){\r\n        //console.log('clicked: resize me')\r\n  \r\n        // enter resize state\r\n        this.setState({\r\n          resizeModeOn: true,\r\n        });\r\n        this.setState({          \r\n          ElementStyle: {\r\n            left: this.state.ElementStyle.left,\r\n            top: this.state.ElementStyle.top,\r\n            height: this.state.ElementStyle.height,\r\n            width: this.state.ElementStyle.width,\r\n            cursor: \"nw-resize\",\r\n          }\r\n        });\r\n        document.addEventListener('mousemove', this.handleResize); \r\n  \r\n      } else if (event.type === 'mousemove'){\r\n        //console.log('listen for mouse-up')\r\n        document.addEventListener('mouseup', this.handleMouseUp); \r\n        this.setState({          \r\n          ElementStyle: {\r\n            left: this.state.ElementStyle.left,\r\n            top: this.state.ElementStyle.top,\r\n            height: this.state.ElementStyle.height,\r\n            width: this.state.ElementStyle.width,\r\n            cursor: \"nw-resize\",\r\n          }\r\n        });\r\n  \r\n        this.setState({ \r\n          possibleResizeModeOn: true, \r\n        });\r\n        if (this.state.resizeModeOn){\r\n          var minwidthheight = 5;\r\n          var offset_framearea = 100;\r\n  \r\n          // stop if width/height == 0\r\n          if (this.state.w >= minwidthheight){\r\n            // add mouse-position to width\r\n            this.setState({\r\n              w: Math.max(minwidthheight,event.pageX - this.state.l - offset_framearea),\r\n            });\r\n      \r\n            this.setState({          \r\n              ElementStyle: {\r\n                left: this.state.ElementStyle.left,\r\n                top: this.state.ElementStyle.top,\r\n                height: this.state.ElementStyle.height,\r\n                width: (this.state.w) + \"px\",\r\n                cursor: \"nw-resize\",\r\n              }\r\n            });\r\n          }\r\n          if (this.state.h >= minwidthheight){\r\n              // add mouse-position to height\r\n              this.setState({\r\n                h: Math.max(minwidthheight, event.pageY - this.state.t - offset_framearea),\r\n              });\r\n        \r\n              this.setState({          \r\n                ElementStyle: {\r\n                  left: this.state.ElementStyle.left,\r\n                  top: this.state.ElementStyle.top,\r\n                  height: (this.state.h) + \"px\",\r\n                  width: this.state.ElementStyle.width,\r\n                  cursor: \"nw-resize\",\r\n                }\r\n              });\r\n            }\r\n  \r\n  \r\n            // only pass changed values to parent\r\n            this.props.handleBBoxUpdate(this.state.l,this.state.t,this.state.w,this.state.h, this.props.number); \r\n        }\r\n      } else if (event.type === \"mouseout\") {\r\n        this.setState({\r\n          possibleResizeModeOn: false,\r\n          ElementStyle: {\r\n            left: this.state.ElementStyle.left,\r\n            top: this.state.ElementStyle.top,\r\n            height: this.state.ElementStyle.height,\r\n            width: this.state.ElementStyle.width,\r\n            cursor: \"move\",\r\n          }\r\n        });\r\n        \r\n      }\r\n      } else {\r\n        this.setState({\r\n          possibleResizeModeOn: false,\r\n          ElementStyle: {\r\n            left: this.state.ElementStyle.left,\r\n            top: this.state.ElementStyle.top,\r\n            height: this.state.ElementStyle.height,\r\n            width: this.state.ElementStyle.width,\r\n            cursor: \"default\",\r\n          }\r\n        });\r\n      }\r\n    }\r\n  \r\n    handleMouseDown = (event) => {\r\n        // only if this is the selected bbox\r\n        if(this.props.isSelected){\r\n          //check if resize is on\r\n          // if click is inside resize-box -> resize\r\n          // otherwise -> drag\r\n  \r\n          if (this.state.possibleResizeModeOn === false){\r\n            this.setState({\r\n              dragModeOn: true,\r\n              diffx: event.pageX - this.state.l,\r\n              diffy: event.pageY - this.state.t,\r\n            });\r\n            document.addEventListener('mousemove', this.handleDrag);\r\n            ReactDOM.findDOMNode(this).removeEventListener('mousedown', this.handleMouseDown);\r\n            document.addEventListener('mouseup', this.handleMouseUp); \r\n          }\r\n      } else {\r\n        this.setState({\r\n          possibleResizeModeOn: false,\r\n          ElementStyle: {\r\n            left: this.state.ElementStyle.left,\r\n            top: this.state.ElementStyle.top,\r\n            height: this.state.ElementStyle.height,\r\n            width: this.state.ElementStyle.width,\r\n            cursor: \"default\",\r\n          }\r\n        });\r\n      }\r\n     }\r\n  \r\n     handleMouseUp = (event) => {\r\n      if(this.props.isSelected){\r\n        //console.log('handle mouse up - remove mouse move listener')\r\n        document.removeEventListener('mousemove', this.handleResize); \r\n          this.setState({          \r\n            ElementStyle: {\r\n              left: this.state.ElementStyle.left,\r\n              top: this.state.ElementStyle.top,\r\n              height: this.state.ElementStyle.height,\r\n              width: this.state.ElementStyle.width,\r\n              cursor: \"move\",\r\n            }\r\n          });\r\n  \r\n          this.setState({\r\n            dragModeOn: false,\r\n            possibleResizeModeOn: false, \r\n            resizeModeOn: false,\r\n          }); \r\n          document.removeEventListener('mousemove', this.handleDrag); \r\n          \r\n          if (ReactDOM.findDOMNode(this) !== undefined){\r\n            ReactDOM.findDOMNode(this).addEventListener('mousedown', this.handleMouseDown);\r\n          }\r\n          document.removeEventListener('mouseup', this.handleMouseUp);\r\n      } else {\r\n        this.setState({\r\n          possibleResizeModeOn: false,\r\n          ElementStyle: {\r\n            left: this.state.ElementStyle.left,\r\n            top: this.state.ElementStyle.top,\r\n            height: this.state.ElementStyle.height,\r\n            width: this.state.ElementStyle.width,\r\n            cursor: \"default\",\r\n          }\r\n        });\r\n      }\r\n     }\r\n  \r\n     handleDrag = (event) => {\r\n      if(this.props.isSelected){\r\n        this.setState({          \r\n          ElementStyle: {\r\n            left: this.state.ElementStyle.left,\r\n            top: this.state.ElementStyle.top,\r\n            height: this.state.ElementStyle.height,\r\n            width: this.state.ElementStyle.width,\r\n            cursor: \"move\",\r\n          }\r\n        });\r\n        if (this.state.dragModeOn === true) {\r\n          this.setState({\r\n            l: event.pageX - this.state.diffx,\r\n            t: event.pageY - this.state.diffy,\r\n          });\r\n  \r\n          this.setState({\r\n            ElementStyle: {\r\n              left: (event.pageX - this.state.diffx) + \"px\",\r\n              top: (event.pageY - this.state.diffy) + \"px\",\r\n              height: this.state.ElementStyle.height,\r\n              width: this.state.ElementStyle.width,\r\n              cursor: \"move\",\r\n            }\r\n          });\r\n          this.props.handleBBoxUpdate(this.state.l,this.state.t,this.state.w,this.state.h, this.props.number); \r\n        }\r\n      }else {\r\n        this.setState({\r\n          possibleResizeModeOn: false,\r\n          ElementStyle: {\r\n            left: this.state.ElementStyle.left,\r\n            top: this.state.ElementStyle.top,\r\n            height: this.state.ElementStyle.height,\r\n            width: this.state.ElementStyle.width,\r\n            cursor: \"default\",\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n  \r\n  export default BoundingBox;"]},"metadata":{},"sourceType":"module"}